#!/usr/bin/python

import sys
import traceback
from datetime import datetime

#[lon, lat, lon, lat]
boxes = [[-74.0151425610029, 40.7291099638567, -73.9997399840679, 40.7428558444185], [-74.0216668553579, 40.5941182659654, -73.9729400064377, 40.6243725931612], [-73.9926238051035, 40.7192801452175, -73.9718363715137, 40.7337200243512], [-73.8041311108691, 40.7376866103462, -73.7708113193187, 40.7663004345915], [-74.0656440604438, 40.6041688623464, -74.0604910232448, 40.6072307465142], [-74.0196873314383, 40.7038545454545, -74.0124268276674, 40.7195847162205], [-73.8420444926886, 40.8041636367839, -73.7901454545543, 40.8385605118159], [-73.9606071438882, 40.7795200091118, -73.9510807856541, 40.7880642112953], [-73.8592609107541, 40.78523156096, -73.8384164696, 40.7968906190217], [-74.1717800085157, 40.605199974296, -74.1428535397387, 40.6427735895654], [-74.23625454562, 40.540849974136, -74.19738183074, 40.5589559233716], [-73.7586661445016, 40.7177774204448, -73.6998272727273, 40.7828181808849], [-73.7585478901235, 40.6896727263399, -73.7260545454545, 40.7313149648882], [-73.8798999751457, 40.8363799765103, -73.838777399356, 40.8580822758743], [-73.993565678994, 40.7272132675693, -73.9713628587838, 40.748649974957], [-73.8558237102448, 40.8577546515954, -73.8418491959597, 40.8770551726516], [-73.8959760024664, 40.7049299867513, -73.8593399891149, 40.7313181808852], [-74.1586876545188, 40.5296042919963, -74.1128500572889, 40.5714377990995], [-73.9032882686355, 40.8519666226678, -73.8799992231053, 40.8692488033809], [-74.1274370416775, 40.618854009465, -74.0683540748256, 40.6495468942592], [-73.9249122428524, 40.8754605718449, -73.9068510205936, 40.8874770150686], [-74.0152972259653, 40.7189528889231, -73.9953699839307, 40.72990919733], [-73.9160891905268, 40.7351270789796, -73.8909811838279, 40.7671335779464], [-73.7429259043159, 40.6346619186137, -73.7248010808468, 40.6535043960505], [-73.9323090909091, 40.7964663033031, -73.9020211853349, 40.8215818181818], [-74.1795605201766, 40.529395374516, -74.1409674840637, 40.5696445503357], [-73.8388726987921, 40.6992589169512, -73.8041311108691, 40.7428457841791], [-73.9900550463824, 40.6086100318651, -73.9249022748373, 40.6420459400994], [-74.0418636363636, 40.609081817873, -74.0158908721504, 40.6416718795717], [-73.876413557386, 40.8567262753865, -73.85489892046, 40.8779014659321], [-74.1462299984691, 40.6240699954608, -74.1213399846202, 40.6425346017308], [-73.9949183041101, 40.6784753922399, -73.977858518938, 40.6902960777978], [-73.823866189888, 40.7970615732604, -73.8111324484416, 40.8005435239154], [-73.9847300128135, 40.7433469029995, -73.9676727276414, 40.753737080094], [-74.0085250837268, 40.6835436441978, -73.9919068572648, 40.6931856964886], [-73.9939531939596, 40.6875359033119, -73.9806510556807, 40.7012725314423], [-73.8626399741531, 40.809829329172, -73.8390958969827, 40.84124337207], [-74.2246200358435, 40.5267000112322, -74.2027791823075, 40.5421178764809], [-73.869345075386, 40.6795726465201, -73.8107399764126, 40.7032898968033], [-74.0004729254517, 40.5716213583079, -73.974550402326, 40.5874752452582], [-73.8844899744305, 40.8041451892078, -73.8471898387239, 40.8374799713054], [-73.8169364097091, 40.6717259481757, -73.7541492201975, 40.725200022444], [-73.7649174035432, 40.645839614773, -73.7248959638023, 40.6952911981975], [-74.0001433772571, 40.7176884026768, -73.9926000104938, 40.7255100352693], [-74.0367545454545, 40.6310699901787, -73.993681365161, 40.6594454545455], [-74.0102505384994, 40.6189208609345, -73.9673286576, 40.6505371890889], [-73.8988400237112, 40.7459328518073, -73.8521943370999, 40.7709977819626], [-73.8969772673119, 40.6425347157039, -73.8556727278085, 40.6906832658821], [-73.9564651967096, 40.6678720905853, -73.9000406287332, 40.7007989031968], [-73.9288841199961, 40.7128877778105, -73.8850727272727, 40.7407120028455], [-73.9816748619464, 40.764504184421, -73.9492799731985, 40.8007162872509], [-73.9793553948405, 40.6505644781065, -73.9628297319117, 40.6727870939831], [-73.9281144887348, 40.8431935725322, -73.9032832514289, 40.8587738057451], [-74.2477636354744, 40.5185699682559, -74.2235099733425, 40.5524636362562], [-73.9025199724177, 40.6817475342621, -73.8529553482835, 40.7129670307708], [-73.8462211402537, 40.8560798391929, -73.8163824771687, 40.8808980030619], [-74.0051799997131, 40.7245899917404, -73.9873400213326, 40.7390700267544], [-73.9923675210856, 40.6474605465079, -73.9694961424134, 40.6846099867022], [-74.000842001598, 40.7482181819879, -73.9619758852909, 40.7737816992534], [-73.9712264492725, 40.8012638186743, -73.9526000192099, 40.8191888293069], [-74.2069758170771, 40.5161457857203, -74.1732888043837, 40.5462700026458], [-73.9596599726649, 40.7968900101733, -73.9291200124546, 40.8309256350301], [-74.2059818190944, 40.5769886023058, -74.1543531833505, 40.635601935156], [-73.9188526823273, 40.7782754375407, -73.8911000964274, 40.7908282506166], [-73.8531461206804, 40.7192984355827, -73.8020744038359, 40.775683823272], [-73.995031315829, 40.6974163766326, -73.9207454544316, 40.7182727282145], [-74.1726798366415, 40.5587388883152, -74.1179514867911, 40.608390271174], [-73.9622496674524, 40.8108099794898, -73.9414611418432, 40.8347683499519], [-73.9123095044728, 40.8706677784474, -73.8937868091431, 40.8892747257303], [-73.9182976499862, 40.8540386788225, -73.8970538872711, 40.873428677864], [-73.9353369564876, 40.5960494361503, -73.8752212025254, 40.6582318522238], [-74.0126999994392, 40.6438675601764, -73.9800752259713, 40.669442618794], [-73.7925272727273, 40.8370636363636, -73.7814545454546, 40.8586909090909], [-73.7838090854595, 40.6780380692753, -73.7430412045622, 40.7201127333768], [-74.1855600006509, 40.521263071774, -74.1567796607803, 40.5487973354715], [-74.0161776265209, 40.7125212059443, -74.0004712806173, 40.7264363636364], [-74.0017061225651, 40.5795727271505, -73.9117830408767, 40.621163270158], [-74.0345347141264, 40.643745429289, -74.00225738691, 40.6726602751014], [-74.121998582688, 40.563743530898, -74.0763260240518, 40.5931354488941], [-74.0035210287275, 40.665185626501, -73.981783678729, 40.6851197985679], [-73.8269854819841, 40.7530049209073, -73.7868630202996, 40.7796343984942], [-73.7895564760899, 40.6524395271067, -73.7524351518366, 40.6826669579515], [-73.967790016764, 40.7538931316271, -73.9584969903509, 40.7608651737848], [-73.9512551040624, 40.7484414462298, -73.9017041513192, 40.7790141859417], [-73.973307125718, 40.7583045689365, -73.9422263593109, 40.7859566528422], [-74.0357272727195, 40.6030269678051, -73.9991314736363, 40.6344787690685], [-74.0176662173091, 40.7003586335877, -73.9991545454545, 40.7156909090909], [-73.9336672984272, 40.8552805355474, -73.9071222788712, 40.8791441859603], [-73.9012095161812, 40.859323461054, -73.8683129946662, 40.88535626887], [-73.9623043689829, 40.7274000118719, -73.9088599702097, 40.7557716112704], [-74.012453770117, 40.7364881635538, -73.9864403842165, 40.7580772561857], [-74.0051730954772, 40.7082454545455, -73.9736685564536, 40.7245899917404], [-73.8690983589247, 40.8732605028262, -73.8332306878934, 40.9104974071578], [-74.1358917994979, 40.5467576839989, -74.0920934810977, 40.5852831832618], [-74.1008165848103, 40.5769846304566, -74.058942830865, 40.6060899630879], [-73.9043981314186, 40.8003040420537, -73.8681852504632, 40.8283799932517], [-74.2564538161861, 40.495691577906, -74.2214804596687, 40.5215099745303], [-74.002960196783, 40.7138548938132, -73.9921479261742, 40.719315085863], [-73.9222381719784, 40.691880020213, -73.8783067198462, 40.7250727263397], [-73.8710873277283, 40.6974519774964, -73.8331378180425, 40.7393033623008], [-73.950314007291, 40.8278316197704, -73.9222579232805, 40.8673871901197], [-73.9430590014167, 40.6174480650764, -73.8901852513675, 40.6778332749438], [-73.9413142657773, 40.6763915251602, -73.8682093495001, 40.7093909098468], [-74.1957980267264, 40.6211199955401, -74.1661534024461, 40.6451090909091], [-73.9420532272423, 40.5426105625147, -73.7357606184883, 40.6206568820497], [-73.9968207116037, 40.7678462235595, -73.9583534536457, 40.8060394047806], [-74.2048057487157, 40.5400999624166, -74.1708113640498, 40.5662419211608], [-74.2250700280314, 40.5020989201129, -74.187802840983, 40.5322815620187], [-73.9853528705967, 40.6698000280158, -73.9521600209564, 40.6986813737458], [-74.0074925940225, 40.7523093040552, -73.9862600127018, 40.767335738786], [-74.2127363636364, 40.5573, -74.1884785057561, 40.5799872125538], [-73.9559070701518, 40.7827818181819, -73.935919994443, 40.7968900101733], [-73.8018355645174, 40.7635120256863, -73.7602608237189, 40.7959184482908], [-73.9335559800785, 40.8211126377762, -73.9119686294725, 40.8455800362365], [-73.9207861558479, 40.8853562686954, -73.8842042388216, 40.9153586798562], [-73.8417138188602, 40.8371909092756, -73.7652909086328, 40.8930979926613], [-73.8937868091431, 40.8809582550195, -73.8598983315724, 40.9084685568029], [-73.9116695482434, 40.8374799717758, -73.873447416546, 40.86054614247], [-73.8599198819639, 40.6444431497759, -73.8496605111475, 40.6534888126238], [-74.1055103678289, 40.6088489513678, -74.0677416607625, 40.6381699919048], [-73.8263269624523, 40.7032645536737, -73.7558799858242, 40.743440743164], [-73.8735100119117, 40.8329100336562, -73.8269539509234, 40.8568988326902], [-73.7911402299322, 40.7894767573298, -73.7752186328553, 40.7967847677329], [-74.1323773214399, 40.589965697991, -74.0904812564868, 40.6110874489109], [-73.925848420501, 40.8122785811274, -73.8798991157707, 40.8439416192428], [-73.9952631164649, 40.746280312471, -73.9810399957203, 40.7573587939712], [-73.9492799731985, 40.7914100220368, -73.9286134631582, 40.8064499724754], [-74.1545247399015, 40.607719968439, -74.0982006646971, 40.6277199645513], [-73.8686085583196, 40.7586808337457, -73.8517864722126, 40.7704072800347]]

def isInBox(lon, lat):
    idxs = []
    for idx,box in enumerate(boxes):
        if box[0] <= lon and box[2] >= lon and box[1] <= lat and box[3] >= lat:
            idxs.append(idx)
            #print names[idx]
    if len(idxs) == 0:
        return [-1]
    return idxs    

#input comes from STDIN (stream data that goes to the program)
for line in sys.stdin:
    try:
        keys = []
        values = []
        rowtype = 1
        items = line.strip().split(',')
    
        if len(items) > 0:
            if items[0] == "VendorID":
                continue
    
        date_obj = datetime.strptime(items[1], '%Y-%m-%d %H:%M:%S')
        keys.append(str(date_obj.year))
        keys.append(str(date_obj.month))
        keys.append(str(date_obj.day))
        date_end = datetime.strptime(items[2], '%Y-%m-%d %H:%M:%S')
        rate_ID = 0
    
        values.append(items[0])
        td = date_end - date_obj
        total_second = (td.microseconds + (td.seconds + td.days * 24 * 3600) * 10**6) / 10**6
        values.append(str(total_second/60.0))
        if len(items) == 23: #green
            rate_ID = int(items[4])
            rowtype = 1
            plon = float(items[5])
            plat = float(items[6])
            dlon = float(items[7])
            dlat = float(items[8])
        elif len(items) == 19: #yellow
            rate_ID = int(items[7])
            rowtype = 2
            plon = float(items[5])
            plat = float(items[6])
            dlon = float(items[9])
            dlat = float(items[10])
        
        pboro = isInBox(plon, plat)
        dboro = isInBox(dlon, dlat)
        print "%s\t%d,%d,%s,%s" % (",".join(keys), rowtype, rate_ID, "_".join(map(str,pboro)), "_".join(map(str,dboro)))
    except:
        traceback.print_exc()
# output
# green
# year,month,day    1,rateID, pick_boros, drop_boros
# yellow
# year,month,day    2,rateID, pick_boros, drop_boros